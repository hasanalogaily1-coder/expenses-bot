<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000);
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container { width: 100%; max-width: 400px; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .menu-btn {
            width: 100%;
            padding: 15px;
            margin: 8px 0;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: white;
            transition: transform 0.1s;
        }
        .menu-btn:active { transform: scale(0.98); }
        
        /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-expense { background-color: #e74c3c; } /* Ø£Ø­Ù…Ø± Ù„Ù„Ù…ØµØ§Ø±ÙŠÙ */
        .btn-income { background-color: #2ecc71; } /* Ø£Ø®Ø¶Ø± Ù„Ù„Ù‚Ø¨Ø¶ */
        .btn-bank { background-color: #3498db; }   /* Ø£Ø²Ø±Ù‚ Ù„Ù„Ù…ØµØ±Ù */
        .btn-contract { background-color: #f39c12; } /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ù„Ù„Ø¹Ù‚ÙˆØ¯ */

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ÙÙˆØ±Ù…Ø© */
        .form-section { display: none; width: 100%; }
        input, textarea {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            background-color: var(--tg-theme-secondary-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000);
        }
        .submit-btn {
            width: 100%;
            padding: 14px;
            background-color: var(--tg-theme-button-color, #2481cc);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .back-btn {
            background: none;
            border: none;
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 15px;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
</head>
<body>

<div class="container">
    
    <div id="mainMenu">
        <h3 style="text-align: center; margin-bottom: 20px;">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ğŸ‘‡</h3>
        <button class="menu-btn btn-expense" onclick="openForm('Ù…ØµØ§Ø±ÙŠÙ ğŸ’¸', '#ØµØ±Ù')">Ù…ØµØ§Ø±ÙŠÙ ğŸ’¸</button>
        <button class="menu-btn btn-income" onclick="openForm('Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ ğŸ“¥', '#Ù‚Ø¨Ø¶')">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ ğŸ“¥</button>
        <button class="menu-btn btn-bank" onclick="openForm('Ø¥ÙŠØ¯Ø§Ø¹ Ù…ØµØ±ÙÙŠ ğŸ¦', '#Ù…ØµØ±Ù')">Ù…ØµØ±Ù ğŸ¦</button>
        <button class="menu-btn btn-contract" onclick="openForm('Ø¹Ù‚Ø¯ Ø¬Ø¯ÙŠØ¯ ğŸ“„', '#Ø¹Ù‚Ø¯')">Ø¹Ù‚ÙˆØ¯ ğŸ“„</button>
    </div>

    <div id="formSection" class="form-section">
        <button class="back-btn" onclick="showMenu()">ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
        <h3 id="formTitle" style="text-align: center;">ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª</h3>
        
        <input type="hidden" id="entryType"> <input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù… / Ø§Ù„Ø¬Ù‡Ø©" required>
        <input type="number" id="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" required>
        <textarea id="details" rows="3" placeholder="Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª..." required></textarea>
        
        <label style="display:block; margin-top:10px;">Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
        <input type="file" id="photo" accept="image/*">

        <button class="submit-btn" onclick="sendData()" id="btn">Ø¥Ø±Ø³Ø§Ù„ ğŸ“¤</button>
        <p id="status" style="text-align: center; display: none; margin-top: 10px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...</p>
    </div>

</div>

<script>
    // ==========================================
    // ğŸ”´ Ø¹Ø¯Ù„ Ù‡Ù†Ø§ Ø¨Ø³
    const BOT_TOKEN = "8134873765:AAFUo-nFXTbmN4_KC2NQQbMXjfEFUxO2s_o"; 
    const CHAT_ID = "5762584781"; 
    // ==========================================

    const tg = window.Telegram.WebApp;
    tg.expand();

    // Ø¯Ø§Ù„Ø© ÙØªØ­ Ø§Ù„ÙÙˆØ±Ù…Ø© ÙˆØªØºÙŠÙŠØ± Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ø²Ø±
    function openForm(title, typeTag) {
        document.getElementById('mainMenu').style.display = 'none';
        document.getElementById('formSection').style.display = 'block';
        document.getElementById('formTitle').innerText = title;
        document.getElementById('entryType').value = typeTag; // Ù†Ø®Ø²Ù† Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        
        // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
        document.getElementById('name').value = '';
        document.getElementById('amount').value = '';
        document.getElementById('details').value = '';
        document.getElementById('photo').value = '';
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
    function showMenu() {
        document.getElementById('formSection').style.display = 'none';
        document.getElementById('mainMenu').style.display = 'block';
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
    function sendData() {
        const typeTag = document.getElementById('entryType').value;
        const name = document.getElementById('name').value;
        const amount = document.getElementById('amount').value;
        const details = document.getElementById('details').value;
        const photoInput = document.getElementById("photo").files[0];
        const btn = document.getElementById("btn");
        const status = document.getElementById("status");

        if (!name || !amount) {
            tg.showAlert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„!");
            return;
        }

        btn.disabled = true;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...";
        status.style.display = "block";

        const caption = `${typeTag}\n\nğŸ‘¤ *Ø§Ù„Ø§Ø³Ù…:* ${name}\nğŸ’° *Ø§Ù„Ù…Ø¨Ù„Øº:* ${amount}\nğŸ“ *Ø§Ù„ØªÙØ§ØµÙŠÙ„:* ${details}`;
        
        const formData = new FormData();
        formData.append("chat_id", CHAT_ID);
        formData.append("caption", caption);
        formData.append("parse_mode", "Markdown");

        // Ø¥Ø°Ø§ Ø£ÙƒÙˆ ØµÙˆØ±Ø©ØŒ Ù†Ø³ØªØ®Ø¯Ù… sendPhotoØŒ Ø¥Ø°Ø§ Ù…Ø§ÙƒÙˆ Ù†Ø³ØªØ®Ø¯Ù… sendMessage
        let url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        if (photoInput) {
            url = `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`;
            formData.append("photo", photoInput);
        } else {
            formData.append("text", caption); // ÙÙŠ Ø­Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© ÙÙ‚Ø·
        }

        fetch(url, { method: "POST", body: formData })
        .then(res => res.json())
        .then(data => {
            if (data.ok) {
                tg.showAlert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­! âœ…");
                showMenu(); // Ù†Ø±Ø¬Ø¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            } else {
                alert("Ø®Ø·Ø£: " + data.description);
            }
        })
        .catch(err => {
            alert("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: " + err);
        })
        .finally(() => {
            btn.disabled = false;
            btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ ğŸ“¤";
            status.style.display = "none";
        });
    }
</script>

</body>
</html>
